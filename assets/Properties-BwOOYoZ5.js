import{r as u,j as e}from"./index-BEqEbxLi.js";import{u as h}from"./useQuery-IM3Ygd_d.js";import{a as g}from"./api-BZS8NOXb.js";import{u as p}from"./index.esm-Cgprhae4.js";const j=({onSubmit:s,onClear:o})=>{const{register:a,handleSubmit:t,reset:n}=p(),[l,c]=u.useState(!1),d=x=>{s(x)},m=()=>{n(),o()};return e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md mb-6",children:[e.jsxs("button",{onClick:()=>c(!l),className:"md:hidden w-full text-left font-semibold text-lg mb-2",children:["Filtros ",l?"▲":"▼"]}),e.jsxs("form",{onSubmit:t(d),className:`space-y-4 ${l?"block":"hidden md:block"}`,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ubicación"}),e.jsx("input",{type:"text",...a("location"),className:"w-full p-2 border border-gray-300 rounded",placeholder:"Ej: Madrid"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Precio Mínimo"}),e.jsx("input",{type:"range",min:"0",max:"1000000",step:"10000",...a("minPrice",{valueAsNumber:!0}),className:"w-full"}),e.jsx("span",{className:"text-sm text-gray-600",children:"€0 - €1,000,000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Precio Máximo"}),e.jsx("input",{type:"range",min:"0",max:"1000000",step:"10000",...a("maxPrice",{valueAsNumber:!0}),className:"w-full"}),e.jsx("span",{className:"text-sm text-gray-600",children:"€0 - €1,000,000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Dormitorios"}),e.jsxs("select",{...a("bedrooms"),className:"w-full p-2 border border-gray-300 rounded",children:[e.jsx("option",{value:"",children:"Todos"}),e.jsx("option",{value:"1",children:"1"}),e.jsx("option",{value:"2",children:"2"}),e.jsx("option",{value:"3",children:"3"}),e.jsx("option",{value:"4",children:"4+"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Mínimos m²"}),e.jsx("input",{type:"range",min:"0",max:"500",step:"10",...a("minSqm",{valueAsNumber:!0}),className:"w-full"}),e.jsx("span",{className:"text-sm text-gray-600",children:"0 - 500 m²"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Máximos m²"}),e.jsx("input",{type:"range",min:"0",max:"500",step:"10",...a("maxSqm",{valueAsNumber:!0}),className:"w-full"}),e.jsx("span",{className:"text-sm text-gray-600",children:"0 - 500 m²"})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:"Aplicar Filtros"}),e.jsx("button",{type:"button",onClick:m,className:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600",children:"Limpiar"})]})]})]})},N=({property:s})=>e.jsxs("article",{className:"bg-white rounded-lg shadow-md overflow-hidden transition-all duration-300 hover:shadow-lg hover:scale-105 animate-fade-in",role:"article","aria-labelledby":`property-title-${s.id}`,children:[e.jsx("img",{src:s.images[0]||"/placeholder.jpg",alt:`Imagen de la propiedad ${s.title} ubicada en ${s.location}`,className:"w-full h-48 object-cover",loading:"lazy"}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{id:`property-title-${s.id}`,className:"text-xl font-semibold mb-2",children:s.title}),e.jsx("p",{className:"text-gray-600 mb-2",children:s.description}),e.jsxs("p",{className:"text-lg font-bold text-blue-600 mb-2","aria-label":`Precio: ${s.price.toLocaleString()} euros`,children:["€",s.price.toLocaleString()]}),e.jsxs("div",{className:"flex justify-between text-sm text-gray-500",children:[e.jsxs("span",{"aria-label":`${s.bedrooms} dormitorios`,children:[s.bedrooms," dormitorios"]}),e.jsxs("span",{"aria-label":`${s.sqm} metros cuadrados`,children:[s.sqm," m²"]})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-2","aria-label":`Ubicación: ${s.location}`,children:s.location})]})]}),P=()=>{const[s,o]=u.useState({location:"",minPrice:0,maxPrice:1e6,bedrooms:"",minSqm:0,maxSqm:500}),[a,t]=u.useState(1),n=12,{data:l,isLoading:c,error:d}=h({queryKey:["properties",s,a],queryFn:async()=>{console.log("Iniciando carga de propiedades con filtros:",s,"página:",a);const i={location:s.location||void 0,minPrice:s.minPrice||void 0,maxPrice:s.maxPrice||void 0,bedrooms:s.bedrooms||void 0,minSqm:s.minSqm||void 0,maxSqm:s.maxSqm||void 0,page:a,limit:n};console.log("Parámetros de la solicitud:",i);try{const r=await g.get("/properties",{params:i});return console.log("Respuesta del backend:",r),r.data}catch(r){throw console.error("Error en la solicitud:",r),r}}}),m=i=>{o(i),t(1)},x=()=>{o({location:"",minPrice:0,maxPrice:1e6,bedrooms:"",minSqm:0,maxSqm:500}),t(1)},b=l?Math.ceil(l.total/n):0;return console.log(l),e.jsx("div",{className:"min-h-screen bg-gray-100",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-center mb-8",children:"Propiedades"}),e.jsx(j,{onSubmit:m,onClear:x}),c&&e.jsx("p",{className:"text-center",children:"Cargando..."}),d&&e.jsx("p",{className:"text-center text-red-500",children:"Error al cargar propiedades."}),l&&e.jsxs(e.Fragment,{children:[console.log("Properties array:",l?.properties),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:l?.properties?.map(i=>(console.log("Rendering property:",i.id),e.jsx(N,{property:i},i.id)))}),b>1&&e.jsxs("div",{className:"flex justify-center space-x-2",children:[e.jsx("button",{onClick:()=>t(a-1),disabled:a===1,className:"px-4 py-2 bg-blue-500 text-white rounded disabled:bg-gray-300",children:"Anterior"}),e.jsxs("span",{className:"px-4 py-2",children:["Página ",a," de ",b]}),e.jsx("button",{onClick:()=>t(a+1),disabled:a===b,className:"px-4 py-2 bg-blue-500 text-white rounded disabled:bg-gray-300",children:"Siguiente"})]})]})]})})};export{P as default};
